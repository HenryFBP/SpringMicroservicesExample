# -*- mode: ruby -*-
# vi: set ft=ruby :

VM_NAME = 'Ubuntu Bionic 18.04 Jenkins'
VM_IP = '192.168.33.22'
VM_RAM_MB = '2000'

Vagrant.configure("2") do |config|

  config.vm.box = "ubuntu/bionic64"

  config.vm.define VM_NAME
  config.vm.network "private_network", ip: VM_IP

  # VirtualBox specific settings
  config.vm.provider "virtualbox" do |vb|

    # Customize the amount of memory on the VM:
    vb.memory = VM_RAM_MB

  end

  config.vm.provision "shell", inline: <<-SHELL

    exit 0 #debug    

    wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | sudo apt-key add -
    sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'

    apt update

    apt-get install -y openjdk-8-jre
    apt-get install -y jenkins
    systemctl start jenkins

    echo "Jenkins is installed! Log in at https://<this VM's IP>:8080/ and follow the instructions."

    curl 127.0.0.1:8080
  SHELL
end
